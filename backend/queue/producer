from backend.queue.celery_app import celery_app
from backend.core.config import settings


def send_task(
    task_name: str,
    payload: dict,
    queue: str | None = None,
    priority: int | None = None,
):
    """
    Send job to Celery queue.
    """

    queue_name = queue or settings.CELERY_DEFAULT_QUEUE

    return celery_app.send_task(
        task_name,
        args=[payload],
        queue=queue_name,
        priority=priority,
        retry=True,
    )